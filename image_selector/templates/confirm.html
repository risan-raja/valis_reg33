{% extends 'base.html' %}

{% block title %}Confirm Selection for {{ slide }}{% endblock %}

{% block content %}
    <h1>Confirm Selected Images for Slide: {{ slide }}</h1>
    <form action="/submit_images" method="POST">
        <div class="row">
            {% for image in selected_images %}
            <div class="col-md-6 text-center mb-4"  onclick="toggleCheckbox(event, '{{ image }}')">
                <div class="card"  onclick="toggleCheckbox(event, '{{ image }}')">
                    <div class="text-center">
                        <img src="{{ url_for('get_slide_stain_image', slide=slide, image_name=image, resolution=300) }}"
                            alt="{{ image }}" class="img-fluid p-2" width="500px" height="auto"
                            onclick="toggleCheckbox(event, '{{ image }}')"><br>
                    </div>
                    <!-- <input type="checkbox" name="selected_images" value="{{ image }}"> -->
                    <div class="form-check form-switch">
                        <input class="form-check-input" type="checkbox" role="switch" value="{{ image }}"
                            name="selected_images" id="flexSwitchCheckDefault{{ image }}" {% if image in selected_files
                            %}checked{% endif %}>
                        <label class="form-check-label" for="flexSwitchCheckDefault{{ image }}">{{ image | replace(".jpg", "")}}</label>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
        <br>
        <button type="submit" class="btn btn-success">Confirm and Submit</button>
        <a href="{{ url_for('show_slide', slide_index=session['current_slide']) }}" class="btn btn-warning">Go Back and Edit</a>
    </form>
    <script>

        function toggleCheckbox(event, file) {
            // Prevent the form from submitting when clicking on the card
            event.preventDefault();
            // Find the checkbox using the file name
            const checkbox = document.getElementById('flexSwitchCheckDefault' + file);
            // Toggle the checkbox state
            checkbox.checked = !checkbox.checked;
        }
    </script>
{% endblock %}
